<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: transparent;
      font-family: Arial, sans-serif;
      color: #E0E0E0;
    }

    /* Wrapper para o gráfico de barras */
    #bar-wrapper {
      text-align: center;
      margin: 0 auto;
      width: 100%;
      max-width: 600px;
      padding: 1rem;
      box-sizing: border-box;
    }
    /* Gráfico ocupa 100% da largura do wrapper */
    #bar-games-by-event {
      width: 100%;
      height: 350px;
    }

    /* Wrapper para o pie chart (exemplo) */
    #pie-wrapper {
      max-width: 600px;
      margin: 0 auto 2rem auto;
      width: 100%;
      padding: 1rem;
      box-sizing: border-box;
    }
    #pie-wins-losses {
      width: 100%;
      height: 350px;
    }

    /* Media query para ecrãs muito pequenos */
    @media (max-width: 400px) {
      #bar-wrapper, #pie-wrapper {
        max-width: 100%;
        padding: 0.5rem;
      }
    }
  </style>
</head>
<body>

  <div id="pie-wrapper">
    <div id="pie-wins-losses"></div>
  </div>

  <div id="bar-wrapper">
    <div id="bar-games-by-event"></div>
  </div>

  <script>
    // Dados dos jogos para gráfico de barras
    const jogos = [
      {evento: 'BLAST Bounty'}, {evento: 'IEM Katowice'}, {evento: 'IEM Katowice'}, 
      {evento: 'RES Showdown 1'}, {evento: 'RES Showdown 1'}, {evento: 'RES Showdown 1'}, 
      {evento: 'PGL Cluj-Napoca'}, {evento: 'PGL Cluj-Napoca'}, {evento: 'PGL Cluj-Napoca'}, 
      {evento: 'PGL Cluj-Napoca'}, {evento: 'PGL Cluj-Napoca'}, {evento: 'PGL Cluj-Napoca'}, 
      {evento: 'ESL Pro League'}, {evento: 'ESL Pro League'}, {evento: 'ESL Pro League'}, 
      {evento: 'ESL Pro League'}, {evento: 'ESL Pro League'}, {evento: 'ESL Pro League'}, 
      {evento: 'ESL Pro League'}, {evento: 'BLAST Austin Qual'}, {evento: 'BLAST Austin Qual'}, 
      {evento: 'BLAST Austin Qual'}, {evento: 'BLAST Austin Qual'}, {evento: 'BLAST Austin Qual'}, 
      {evento: 'IEM Melbourne'}, {evento: 'IEM Melbourne'}, {evento: 'MESA Masters'}, 
      {evento: 'MESA Masters'}, {evento: 'CCT Europe S3'}, {evento: 'CCT Europe S3'}, 
    ];

    const jogosPorEvento = {};
    jogos.forEach(j => {
      jogosPorEvento[j.evento] = (jogosPorEvento[j.evento] || 0) + 1;
    });

    const eventos = Object.keys(jogosPorEvento);
    const totalJogosEvento = eventos.map(e => jogosPorEvento[e]);

    const barData = [{
      x: eventos,
      y: totalJogosEvento,
      type: 'bar',
      marker: {color: '#636efa'},
      hovertemplate: '%{x}: %{y} jogos<extra></extra>'
    }];

    const barLayoutBase = {
      autosize: false,
      height: 350,
      font: {family: 'Arial, sans-serif', color: '#E0E0E0'},
      paper_bgcolor: 'rgba(0,0,0,0)',
      plot_bgcolor: 'rgba(0,0,0,0)',
      margin: {t:30, b:70, l:40, r:20},
      xaxis: {
        tickangle: -45,
        tickfont: {size: 12, color: '#CCC'},
        automargin: true,
        title: 'Evento'
      },
      yaxis: {
        title: 'Número de jogos',
        tickfont: {color: '#CCC'},
        gridcolor: 'rgba(255,255,255,0.1)'
      },
      showlegend: false
    };

    function drawBarChart() {
      const container = document.getElementById('bar-games-by-event');
      const width = container.clientWidth;

      const layout = {
        ...barLayoutBase,
        width: width
      };

      Plotly.newPlot('bar-games-by-event', barData, layout, {
        responsive: false,
        displayModeBar: false
      });
    }

    // Chama a função inicial e no resize para garantir responsividade real
    drawBarChart();
    window.addEventListener('resize', drawBarChart);

    // Exemplo para o pie chart (se quiseres, posso ajudar a completar)
    const totalVitorias = 15;
    const totalDerrotas = 15;

    const pieData = [{
      values: [totalVitorias, totalDerrotas],
      labels: ['Vitórias', 'Derrotas'],
      type: 'pie',
      marker: {colors: ['#00CC96', '#EF553B']},
      textinfo: 'label+percent',
      textposition: 'outside',
      automargin: true,
      hoverinfo: 'label+value',
      hole: 0.4
    }];

    const pieLayoutBase = {
      autosize: false,
      height: 350,
      font: {family: 'Arial, sans-serif', color: '#E0E0E0'},
      paper_bgcolor: 'rgba(0,0,0,0)',
      plot_bgcolor: 'rgba(0,0,0,0)',
      margin: {t:20, b:20, l:20, r:20},
      showlegend: true,
      legend: {
        font: {color: '#CCC', size: 14},
        orientation: 'h',
        x: 0.5,
        xanchor: 'center',
        y: -0.1
      }
    };

    function drawPieChart() {
      const container = document.getElementById('pie-wins-losses');
      const width = container.clientWidth;

      const layout = {
        ...pieLayoutBase,
        width: width
      };

      Plotly.newPlot('pie-wins-losses', pieData, layout, {
        responsive: false,
        displayModeBar: false
      });
    }

    drawPieChart();
    window.addEventListener('resize', drawPieChart);

  </script>
</body>
</html>
